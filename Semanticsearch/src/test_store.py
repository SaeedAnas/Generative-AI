from helpers.db import db
# db.drop_tables()
# db.create_tables()
conninfo = "dbname=postgres user=postgres password=example host=localhost port=5432"

id = 1
text = "HELLO"
vector = [0.011494457721710205, 0.023462004959583282, 0.002645118162035942, 0.005264272913336754, 0.011134008876979351, -0.12983644008636475, -0.09649495780467987, -0.015295593068003654, -0.008285660296678543, 0.041889045387506485, -0.04803505539894104, -0.021007828414440155, 0.0028949391562491655, -0.01327822171151638, 0.04376542195677757, 0.025058727711439133, -0.030079467222094536, -0.06649639457464218, 0.031107744202017784, -0.010740366764366627, 0.05005377158522606, -0.10312578827142715, -0.04901053011417389, -0.0634552612900734, 0.05173475667834282, -0.05089171975851059, -0.020999398082494736, -0.023485854268074036, 0.06686648726463318, 0.003184386994689703, -0.01630518212914467, 0.03570270910859108, 0.12796294689178467, 0.06339946389198303, 0.023981772363185883, -0.00763714499771595, 0.0033096878323704004, 0.012482905760407448, 0.027376219630241394, 0.14419585466384888, -0.033381469547748566, 0.10305016487836838, 0.027860963717103004, 0.04645991325378418, -0.008092770352959633, 0.02251381427049637, -0.10244856029748917, 0.048148926347494125, -0.06428982317447662, -0.08354199677705765, -0.05707361921668053, 0.005668005906045437, -0.07347758114337921, -0.03950595483183861, 0.030966969206929207, -0.09478985518217087, -0.014556356705725193, 0.020604144781827927, 0.03942778706550598, 0.026679087430238724, 0.07366016507148743, -0.04683039337396622, -0.03516054153442383, -0.03386735916137695, 0.10196840763092041, 0.01982828602194786, 0.09840348362922668, -0.025982322171330452, 0.014282569289207458, 0.05375130847096443, -0.021995194256305695, -0.00252359826117754, -0.10415058583021164, 0.05774610489606857, 0.09146531671285629, 0.016379142180085182, -0.02903178334236145, 0.01099445205181837, -0.08521782606840134, 0.021172208711504936, -0.0854315534234047, 0.0059540756046772, -0.01290818676352501, -0.02145511656999588, -0.011068040505051613, -0.06424445658922195, -0.05339793488383293, -0.08484270423650742, 0.14205506443977356, -0.03620404005050659, -0.005992711987346411, -0.0282891895622015, -0.09290432929992676, -0.012558193877339363, 0.03209676966071129, 0.024296045303344727, -0.006286217365413904, 0.14380699396133423, 0.04768368601799011, -0.03484150394797325, 0.0065490081906318665, 0.02931886352598667, 0.03182142227888107, -0.07075284421443939, -0.0035107301082462072, 0.09564723819494247, 0.09116943925619125, 0.047691553831100464, 0.003707936266437173, -0.07934317737817764, -0.012599863111972809, -0.02942989021539688, 0.06527577340602875, 0.026448583230376244, -0.001925499876961112, -0.009217177517712116, 0.023649483919143677, -0.018847906962037086, -0.03204559534788132, 0.00934227742254734, 0.030203528702259064, 0.0046187289990484715, -0.0024130542296916246, -0.06566639244556427, -0.07499556243419647, 0.0366116464138031, -0.04773719236254692, 3.261940620208199e-33, 0.02095978520810604, 0.07481877505779266, 0.007595738861709833, -0.02011239528656006, 0.011609873734414577, 0.017264312133193016, -0.01348884031176567, -0.02581782080233097, -0.05650361627340317, 0.09749587625265121, -0.06133642420172691, 0.10547517240047455, -0.017535673454403877, 0.01076218020170927, 0.09383122622966766, 0.0038027544505894184, 0.10107150673866272, 0.03890571743249893, -0.047966815531253815, -0.06562478095293045, 0.1790415644645691, -0.0454719178378582, -0.012287500314414501, -0.08841416239738464, 0.07148407399654388, -0.030562449246644974, 0.08590858429670334, -0.0604204423725605, -0.02753620035946369, -0.009630805812776089, -0.08746623992919922, 0.010060603730380535, -0.01811671070754528, 0.05584902688860893, 0.01955549605190754, -0.008140400983393192, -0.04267041012644768, 0.01800878345966339, -0.015214805491268635, -0.08587615936994553, -0.01288125291466713, 0.0022940777707844973, 0.009003854356706142, -0.017661862075328827, -0.07020774483680725, -0.0006110394024290144, -0.023716749623417854, 0.008067556656897068, 0.058321963995695114, 0.00701611815020442, 0.01958606019616127, 0.004169040825217962, -0.07880593091249466, 0.03869784250855446, 0.06064077839255333, 0.06306158006191254, 0.14522482454776764, 0.0698043555021286, 0.06018652394413948, 0.16056391596794128, 0.007399079389870167, -0.06577327847480774, -0.052299756556749344, -0.009612844325602055, -
          0.012766205705702305, 0.00925933476537466, -0.03563592955470085, -0.024477999657392502, 0.12184832990169525, -0.027903348207473755, 0.0312084648758173, -0.03266415745019913, 0.04301827400922775, -0.026748549193143845, 0.03821472451090813, -0.056219927966594696, 0.02168792113661766, -0.05125824362039566, -0.03686876222491264, -0.059624820947647095, -0.1423201858997345, -0.01109810546040535, 0.0395471528172493, -0.04128123074769974, -0.0326363667845726, -0.11263932287693024, 0.024347519502043724, -0.022485654801130295, -0.051870983093976974, 0.004255608189851046, -0.025049449875950813, 0.031076835468411446, -0.003007332794368267, -0.045660242438316345, 0.019878705963492393, -2.966772886690769e-33, -0.05053865164518356, -0.06264784187078476, 0.023634744808077812, 0.029454339295625687, 0.04334773123264313, -0.021811753511428833, -0.035580068826675415, -0.09886037558317184, 0.05914628878235817, -0.012942803092300892, 0.008824409916996956, -0.010151109658181667, -0.0008956211968325078, 0.0019608624279499054, -0.014064034447073936, 0.07620365172624588, 0.05624398961663246, 0.015671394765377045, -0.03351343050599098, -0.0030452613718807697, 0.04072372242808342, 0.051922935992479324, -0.01648356020450592, 0.025803474709391594, 0.016321053728461266, -0.013450958766043186, -0.012890733778476715, 0.009411055594682693, -0.021296918392181396, 0.03980310261249542, -0.057240214198827744, -0.04037513956427574, -0.04971705377101898, -0.0007563925464637578, 0.013353201560676098, -0.0022591345477849245, 0.04248248040676117, 0.061426080763339996, -0.011438179761171341, 0.013594956137239933, 0.003272709669545293, -0.028432002291083336, -0.060834549367427826, -0.007946194149553776, 0.10223333537578583, 0.03573651239275932, 0.007251622620970011, -0.02389412373304367, -0.02486702799797058, 0.01715165190398693, 0.10445333272218704, 0.032987240701913834, 0.036550071090459824, 0.021280908957123756, 0.04272355139255524, -0.008680776692926884, -0.0437866672873497, 0.07748162746429443, -0.038742147386074066, -0.07708273082971573, -0.03754897788167, -0.0122773926705122, -0.029933307319879532, 0.03650573268532753, -0.02275511994957924, -0.03416658565402031, 0.016878396272659302, -0.05244673416018486, -0.02553122118115425, 0.03873163461685181, -0.04848757013678551, -0.0004916274920105934, -0.0623181089758873, -0.013205000199377537, -0.06940517574548721, -0.02455190010368824, -0.000293656368739903, 0.04121847450733185, -0.025238418951630592, 0.06264084577560425, -0.0326547846198082, 0.07898180931806564, 0.04912307485938072, 0.042202893644571304, 9.667324047768489e-05, 0.0017234195256605744, 0.07557997107505798, 0.015349148772656918, -0.060472145676612854, 0.08064033091068268, -0.011828823946416378, 0.009101777337491512, -0.03262430429458618, 0.000965137267485261, 0.023068299517035484, -2.522007847005625e-08, -0.05833513289690018, 0.004365317523479462, 0.03042290173470974, 0.00911012664437294, 0.12258689850568771, -0.036596596240997314, -0.0027212542481720448, 0.1323210895061493, -0.08496692031621933, 0.04305370897054672, 0.04148944094777107, 0.010329583659768105, -0.02815900556743145, 0.06811068952083588, 0.07537511736154556, -0.00629615131765604, 0.01160380244255066, -0.06673229485750198, -0.046325381845235825, -0.02771393209695816, -0.032764554023742676, 0.04855352267622948, -0.021065229550004005, 0.06299350410699844, 0.0009472863166593015, -0.03729326277971268, -0.06905225664377213, -0.056087926030159, 0.0029219714924693108, 0.016710586845874786, 0.027483221143484116, 0.02682412415742874, 0.015226777642965317, -0.011379123665392399, 0.012438773177564144, -0.01686743274331093, -0.016162177547812462, 0.027889523655176163, -0.07014916837215424, 0.06506475806236267, 0.029590977355837822, 0.006697328761219978, 0.0005928333266638219, 0.04661257937550545, 0.052937719970941544, 0.018486127257347107, -0.04129200428724289, -0.0145412040874362, -0.03783506527543068, -0.06601611524820328, 0.00042648447561077774, -0.05495455488562584, -0.0597081296145916, -0.006843829993158579, -0.015379862859845161, 0.06699950248003006, -0.07988672703504562, -0.00855334848165512, 0.06464961916208267, 0.01936420425772667, 0.07982441782951355, -0.023839784786105156, 0.05755837261676788, -0.0068644261918962]

with db.connect() as conn:
    id = conn.execute(
        "INSERT INTO chunks (document_id, chunk_text, chunk_vector) VALUES (%s, %s, %s) RETURNING id;", (
            id, text, vector)
    ).fetchone()
    conn.commit()
    print(id)
